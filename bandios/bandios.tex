\documentclass[11pt,a4paper]{article}
\usepackage[T1]{fontenc}
\begin{document}
\title{Bandios}
\author{Alföldi Mátyás}
\maketitle
\tableofcontents
\pagebreak
\section*{Introduction}
\markright{}
\addcontentsline{toc}{section}{Introduction}
File: Onlineinstaller.bin\newline
VT: https://www.virustotal.com/gui/file/59c662a5207c6806046205348b22\newline
ee45da3f685fe022556716dbbd6643e61834
\newpage
\section*{VT report}
\markright{}
\addcontentsline{toc}{section}{VT report}
All the sections have an entropy of 6+, and the .rsrc section is close to 8, so there will definitely be some unpacking.\newline
There is also a zip file, which is related to plenty of malware, but isn't detected, I would say that it is most likely password protected,
like in the case of WannaCry.\newline
It also has quite a few exports, which is rather strange for an exe.\newline
Interesting Imports:
\begin{itemize}
\item GetAdaptersInfo
\item Http* functions
\item Internet* functions
\item \_TrackMouseEvent (Anti automatic sandbox analysis?)
\item CreateEvent,CreateThread,CreateProcess,WaitForSingleObject combo
\item Sleep (Anti vm?)
\item SetUnhandledExceptionFilter+UnhandledExceptionFilter combo
\item LoadLibrary* functions + GetProcAddress
\item Various file operations Copy/Move/Read/Write
\item Heap related functions
\item Tls functions
\item System information gathering
\item Resource handling functions
\item GetCurrentDirectory/TempPath + SetCurrentDirectory
\item DuplicateHandle (possibly used as a defense mechanism)
\item QueryPerformanceCounter
\item IsProcessorFeaturePresent
\item GetTickCount
\item Service related functions
\item Registry related functions
\item CreateStreamOnHGlobal
\item Com related functions + Variant
\item File time gathering/modification
\end{itemize}
Network related:
\begin{itemize}
\item DNS resolution for iostream.system.band
\item HTTP request to iostream.system.band/dump/io/time.php
\end{itemize}
File readings:
\begin{itemize}
\item Internet cache/history/cookies
\item autoexec.bat
\item On some systems it opens \textbackslash \textbackslash.\textbackslash PIPE\textbackslash lsarpc and \textbackslash\textbackslash.\textbackslash PIPE\textbackslash ROUTER
\end{itemize}
File modifications:
\begin{itemize}
\item <sys32>\textbackslash spoolsr.exe
\item <sys32>\textbackslash MS.dat
\item <sys32>\textbackslash KeyHook32.dll
\item <sys32>\textbackslash KH.dat
\item <sys32>\textbackslash usp20.dll
\item <sys32>\textbackslash UP.dat
\item <sys32>\textbackslash drivers\textbackslash iaStorE.sys
\item <tmp>\textbackslash 996E.tmp
\end{itemize}
Based on the above spoolsr.exe-MS.dat KeyHook32.dll-KH.dat usp20.dll-UP.dat belong together.\newline
The first is related to printers, and possibly data sent out for printing will be stored in MS.dat.\newline
The second is related to keylogging.\newline
And the driver is a defense mechanism.\newline
Registry modifications:
\begin{itemize}
\item Deletes proxy related keys.
\item Sets the SavedLegacySettings key
\end{itemize}
Services related:
\begin{itemize}
\item Creates the iaStorE service (the above mentioned driver) and also opens RASMAN
\end{itemize}
Mutexes:
\begin{itemize}
\item RasPbFile
\item ZonesCounterMutex
\item ZonesCacheCounterMutex
\item ZonesLockedCacheCounterMutex
\end{itemize}
\newpage
\section*{Static Analysis}
\markright{}
\addcontentsline{toc}{section}{Static Analysis}
\end{document}